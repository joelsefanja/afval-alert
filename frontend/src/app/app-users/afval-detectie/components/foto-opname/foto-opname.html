<div class="foto-opname-container">
  <!-- Camera weergave -->
  <mat-card class="camera-card" *ngIf="heeftCameraStream() && !heeftFoto()">
    <mat-card-content>
      <div class="video-container">
        <video #videoElement autoplay playsinline muted></video>
        <div class="camera-overlay">
          <button mat-fab color="primary" class="capture-button" (click)="maakFoto()" [disabled]="isBezig()"
            aria-label="Maak foto">
            <mat-icon *ngIf="!isBezig()">camera_alt</mat-icon>
            <mat-spinner *ngIf="isBezig()" diameter="24"></mat-spinner>
          </button>
        </div>
      </div>
    </mat-card-content>
    <mat-card-actions align="center">
      <button mat-button (click)="stopCamera()">
        <mat-icon>close</mat-icon>
        Annuleren
      </button>
    </mat-card-actions>
  </mat-card>

  <!-- Foto voorvertoning -->
  <mat-card class="foto-preview-card" *ngIf="heeftFoto()">
    <mat-card-content>
      <canvas #canvasElement class="verborgen-canvas"></canvas>
      <div class="foto-container">
        <img [src]="krijgCanvasDataURL()" alt="Gemaakte foto" class="preview-foto" />
      </div>

      <!-- Afval herkenning resultaten -->
      <div class="herkenning-resultaten" *ngIf="afvalSoorten().length > 0 && !toonHandmatigeSelectie()">
        <h3>Herkend afval</h3>
        <mat-chip-listbox>
          <mat-chip-option *ngFor="let soort of afvalSoorten()" selected="true" disabled="true">
            {{ soort }}
          </mat-chip-option>
        </mat-chip-listbox>
      </div>

      <!-- Handmatige selectie -->
      <div class="handmatige-selectie" *ngIf="toonHandmatigeSelectie()">
        <h3>Selecteer afvalsoort</h3>
        <p class="selectie-uitleg">Kies welk type afval je ziet op de foto:</p>
        <mat-chip-listbox multiple>
          <mat-chip-option *ngFor="let soort of beschikbareAfvalSoorten" [selected]="afvalSoorten().includes(soort)"
            (click)="selecteerAfvalSoort(soort)">
            {{ soort }}
          </mat-chip-option>
        </mat-chip-listbox>

        <div class="selectie-acties">
          <button mat-raised-button color="primary" (click)="bevestigHandmatigeSelectie()"
            [disabled]="afvalSoorten().length === 0">
            Bevestigen
          </button>
        </div>
      </div>
    </mat-card-content>

    <mat-card-actions align="center">
      <button mat-button (click)="resetFoto()">
        <mat-icon>refresh</mat-icon>
        Nieuwe foto
      </button>
    </mat-card-actions>
  </mat-card>

  <!-- Start scherm -->
  <mat-card class="start-card" *ngIf="!heeftCameraStream() && !heeftFoto()">
    <mat-card-content>
      <div class="start-content">
        <mat-icon class="grote-icon">photo_camera</mat-icon>
        <h2>Maak een foto van afval</h2>
        <p>De app herkent automatisch wat voor afval het is</p>
      </div>
    </mat-card-content>

    <mat-card-actions align="center">
      <button mat-fab color="primary" class="start-camera-button" (click)="startCamera()" [disabled]="isBezig()"
        aria-label="Start camera">
        <mat-icon *ngIf="!isBezig()">camera_alt</mat-icon>
        <mat-spinner *ngIf="isBezig()" diameter="24"></mat-spinner>
      </button>

      <div class="of-divider">
        <span>of</span>
      </div>

      <button mat-stroked-button color="primary" (click)="openBestandsKiezer()" [disabled]="isBezig()">
        <mat-icon>upload</mat-icon>
        Upload foto
      </button>
    </mat-card-actions>
  </mat-card>

  <!-- Verborgen file input -->
  <input #fileInput type="file" accept="image/*" (change)="verwerkBestandsUpload($event)" style="display: none;" />
</div>